{% extends "base.html" %}

{% block title %}Digests - Idea Digest{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-badge">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
        Archive
    </div>
    <h1>Daily Digests</h1>
    <p>Curated summaries of the best ideas, organized by date</p>
</div>

{% if digests %}
<div class="digests-timeline">
    {% for digest in digests %}
    <a href="/digest/{{ digest.date }}" class="digest-card">
        <!-- Date display -->
        <div class="digest-date-block">
            <div class="date-month">{{ digest.date[5:7] }}/{{ digest.date[:4] }}</div>
            <div class="date-day">{{ digest.date[8:10] }}</div>
            <div class="date-weekday">
                {% set weekdays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
                {{ weekdays[(digest.date|replace('-','')|int % 7)] }}
            </div>
        </div>
        
        <!-- Content -->
        <div class="digest-main">
            <div class="digest-title">
                <h3>Daily Digest</h3>
                <span class="digest-label">{{ digest.date }}</span>
            </div>
            <p class="digest-summary">A curated collection of trending ideas from Hacker News, Product Hunt, and GitHub.</p>
            <div class="digest-meta">
                <span class="meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14,2 14,8 20,8"/>
                    </svg>
                    Markdown
                </span>
                <span class="meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </svg>
                    Auto-generated
                </span>
            </div>
        </div>
        
        <!-- Arrow -->
        <div class="digest-action">
            <div class="action-btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="5" y1="12" x2="19" y2="12"/>
                    <polyline points="12 5 19 12 12 19"/>
                </svg>
            </div>
        </div>
    </a>
    {% endfor %}
</div>

<!-- Info section -->
<div class="digests-info">
    <div class="info-card">
        <div class="info-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="16" x2="12" y2="12"/>
                <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
        </div>
        <div class="info-content">
            <h4>How digests work</h4>
            <p>Digests are automatically generated when you run the pipeline. Each digest contains a summary of ideas collected that day, organized by source and scored by relevance.</p>
        </div>
    </div>
</div>

{% else %}
<div class="empty-state">
    <div class="empty-icon">
        <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
            <line x1="9" y1="14" x2="15" y2="14"/>
        </svg>
    </div>
    <h2>No digests yet</h2>
    <p>Run the pipeline to generate your first digest.</p>
    <div class="empty-hint">
        <code>python main.py --digest</code>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_css %}
<style>
    .header-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        background: rgba(139, 92, 246, 0.1);
        border: 1px solid rgba(139, 92, 246, 0.2);
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--accent-purple);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: var(--space-4);
    }

    .header-badge svg {
        opacity: 0.8;
    }

    /* Timeline layout */
    .digests-timeline {
        display: flex;
        flex-direction: column;
        gap: var(--space-4);
    }

    .digest-card {
        position: relative;
        display: grid;
        grid-template-columns: auto 1fr auto;
        gap: var(--space-5);
        align-items: center;
        padding: var(--space-5);
        background: var(--bg-surface);
        border: 1px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        text-decoration: none;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
    }

    .digest-card::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 4px;
        background: linear-gradient(180deg, var(--accent-primary), var(--accent-purple));
        opacity: 0;
        transition: opacity 0.25s ease;
    }

    .digest-card:hover {
        border-color: var(--border-default);
        transform: translateX(4px);
        box-shadow: 
            0 8px 30px -10px rgba(0, 0, 0, 0.3),
            0 0 0 1px rgba(255, 255, 255, 0.03);
    }

    .digest-card:hover::before {
        opacity: 1;
    }

    /* Date block */
    .digest-date-block {
        width: 72px;
        height: 72px;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
        border: 1px solid rgba(59, 130, 246, 0.15);
        border-radius: var(--radius-md);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        transition: all 0.25s ease;
    }

    .digest-card:hover .digest-date-block {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(139, 92, 246, 0.15));
        border-color: rgba(59, 130, 246, 0.25);
    }

    .date-month {
        font-size: 0.625rem;
        font-weight: 600;
        color: var(--text-tertiary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .date-day {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
        line-height: 1.1;
        font-family: var(--font-mono);
    }

    .date-weekday {
        font-size: 0.625rem;
        font-weight: 500;
        color: var(--accent-primary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    /* Main content */
    .digest-main {
        min-width: 0;
    }

    .digest-title {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        margin-bottom: var(--space-2);
    }

    .digest-title h3 {
        font-size: 1.0625rem;
        font-weight: 600;
        color: var(--text-primary);
    }

    .digest-label {
        font-family: var(--font-mono);
        font-size: 0.6875rem;
        font-weight: 500;
        padding: 3px 8px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-subtle);
        border-radius: 4px;
        color: var(--text-tertiary);
    }

    .digest-summary {
        font-size: 0.8125rem;
        color: var(--text-tertiary);
        line-height: 1.5;
        margin-bottom: var(--space-3);
    }

    .digest-meta {
        display: flex;
        gap: var(--space-4);
    }

    .meta-item {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 0.6875rem;
        font-weight: 500;
        color: var(--text-tertiary);
    }

    .meta-item svg {
        opacity: 0.6;
    }

    /* Action button */
    .digest-action {
        flex-shrink: 0;
    }

    .action-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid var(--border-subtle);
        border-radius: 10px;
        color: var(--text-tertiary);
        transition: all 0.25s ease;
    }

    .digest-card:hover .action-btn {
        background: var(--accent-primary);
        border-color: var(--accent-primary);
        color: white;
        transform: translateX(2px);
    }

    /* Info card */
    .digests-info {
        margin-top: var(--space-8);
    }

    .info-card {
        display: flex;
        gap: var(--space-4);
        padding: var(--space-5);
        background: rgba(59, 130, 246, 0.05);
        border: 1px solid rgba(59, 130, 246, 0.1);
        border-radius: var(--radius-lg);
    }

    .info-icon {
        flex-shrink: 0;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(59, 130, 246, 0.1);
        border-radius: 10px;
        color: var(--accent-primary);
    }

    .info-content h4 {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: var(--space-1);
    }

    .info-content p {
        font-size: 0.8125rem;
        color: var(--text-tertiary);
        line-height: 1.5;
    }

    /* Empty state enhancements */
    .empty-state .empty-icon {
        color: var(--text-tertiary);
        opacity: 0.4;
        margin-bottom: var(--space-4);
    }

    .empty-hint {
        margin-top: var(--space-4);
    }

    .empty-hint code {
        font-family: var(--font-mono);
        font-size: 0.8125rem;
        padding: var(--space-2) var(--space-4);
        background: var(--bg-elevated);
        border: 1px solid var(--border-default);
        border-radius: var(--radius-md);
        color: var(--accent-cyan);
    }

    /* Responsive */
    @media (max-width: 640px) {
        .digest-card {
            grid-template-columns: 1fr;
            gap: var(--space-4);
        }

        .digest-date-block {
            width: 100%;
            height: auto;
            flex-direction: row;
            gap: var(--space-3);
            padding: var(--space-3);
        }

        .date-day {
            font-size: 1.25rem;
        }

        .digest-action {
            display: none;
        }
    }

    /* Animation */
    .digest-card {
        animation: slideIn 0.4s ease-out backwards;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateX(-12px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .digest-card:nth-child(1) { animation-delay: 0.05s; }
    .digest-card:nth-child(2) { animation-delay: 0.1s; }
    .digest-card:nth-child(3) { animation-delay: 0.15s; }
    .digest-card:nth-child(4) { animation-delay: 0.2s; }
    .digest-card:nth-child(5) { animation-delay: 0.25s; }
</style>
{% endblock %}
